variables:
    SONAR_TOKEN: "9d6c037c230fbfcc8739c0efce00822d42ba277c"
    SONAR_HOST_URL: "http://sonarqube.lumigame.com/"
    SONAR_USER_HOME: "${CI_PROJECT_DIR}/.sonar" # Defines the location of the analysis task cache
    GIT_DEPTH: 0 # Tells git to fetch all the branches of the project, required by the analysis task
cache:
    key: ${CI_JOB_NAME}
    paths:
        - .sonar/cache

sonarqube-check:
    stage: test
    image:
        name: sonarsource/sonar-scanner-cli:latest
    before_script:
        - echo "===========Start Sonar Scanner============="
    script:
        - sonar-scanner -Dsonar.qualitygate.wait=true -Dsonar.projectKey=$PROJECT_NAME -Dsonar.sources=.
    allow_failure: true
    rules:
    - if: '$CI_COMMIT_BRANCH =~ /^dev-*/'
      when: always
    - if: '$CI_COMMIT_BRANCH == "master"'
      when: always

